<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>fitzCode</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow-x: hidden;
      display: flex;
      font-family: 'Apple SD Gothic Neo', sans-serif;
    }

    .adminSidebarWrap {
      position: relative;
      width: 250px;
      height: 100vh;
      font-family: 'Apple SD Gothic Neo', sans-serif;
    }

    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 250px;
      height: 100vh;
      background-color: #f8f9fa;
      padding: 20px;
      color: #333;
    }

    .sidebar-header {
      position: relative;
      margin-bottom: 20px;
    }

    .sidebar-logo {
      display: block;
      width: 180px;
      height: auto;
      padding-top: 20px;
      padding-bottom: 20px;
      padding-left: 30px;
    }

    .sidebar-header h2 {
      font-size: 1.5em;
      color: #222;
      font-weight: bold;
      padding-left: 30px;
    }

    .sidebar-section h3 {
      font-size: 1.1em;
      margin: 15px 0 10px;
      color: #555;
      font-weight: 500;
      padding-left: 30px;
      transition: color 0.3s ease;
      cursor: pointer;
    }

    .sidebar-section h3:hover {
      color: #666;
    }

    .sidebar-section-dashboard h3 a {
      font-size: 1.3em;
      font-weight: bold;
      margin: 15px 0 34px;
      color: black;
      text-decoration: none;
      display: block;
      transition: color 0.3s ease;
    }

    .sidebar-section-dashboard h3 a:hover {
      color: #666;
    }

    .submenu {
      display: none;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
    }

    .submenu.active {
      display: block;
      max-height: 500px;
      transition: max-height 0.3s ease-in;
    }

    .submenu a {
      display: block;
      padding: 8px 0 8px 42px;
      color: #888;
      text-decoration: none;
      font-size: 0.9em;
      transition: color 0.3s ease;
    }

    .submenu a:hover {
      color: #666;
    }

    .sidebar-section,
    .sidebar-section-dashboard {
      margin-bottom: 15px;
    }

    .submenu a.active {
      font-weight: bold;
      color: #2f2f32;
    }
  </style>
</head>
<body>
<!-- 사이드바 -->
<div th:fragment="sidebar" class="adminSidebarWrap">
  <div class="sidebar">
    <div class="sidebar-header">
      <!-- 로고 -->
      <!-- <a th:href="@{/}">
          <img th:src="@{/img/fitzLogo.png}" alt="관리자 로고" class="sidebar-logo">
      </a> -->
    </div>

    <!-- 현재 페이지 URI 가져오기 -->
    <th:block th:with="currentUri=${currentUri}">
      <!-- 대시보드 -->
      <div class="sidebar-section sidebar-section-dashboard">
        <h3>
          <a th:href="@{/admin/dashboard}"
             th:classappend="${currentUri == '/admin/dashboard'} ? 'active'">
            관리자 대시보드
          </a>
        </h3>
      </div>

      <!-- 판매 관리 -->
      <div class="sidebar-section">
        <h3>판매 관리</h3>
        <div class="submenu">
          <a th:href="@{/admin/sales}"
             th:classappend="${currentUri == '/admin/sales'} ? 'active'">
            판매 현황
          </a>
          <a th:href="@{/admin/products/refund}"
             th:classappend="${currentUri == '/admin/products/refund'} ? 'active'">
            환불
          </a>
          <a th:href="@{/admin/orders}"
             th:classappend="${currentUri == '/admin/orders'} ? 'active'">
            주문 및 배송
          </a>
        </div>
      </div>

      <!-- 회원 관리 -->
      <div class="sidebar-section">
        <h3>회원 관리</h3>
        <div class="submenu">
          <a th:href="@{/admin/members}"
             th:classappend="${currentUri == '/admin/members'} ? 'active'">
            회원 목록
          </a>
        </div>
      </div>

      <!-- 상품 관리 -->
      <div class="sidebar-section">
        <h3>상품 관리</h3>
        <div class="submenu">
          <a th:href="@{/admin/products}"
             th:classappend="${currentUri == '/admin/products'} ? 'active'">
            상품 관리
          </a>
          <a th:href="@{/admin/pick}"
             th:classappend="${currentUri == '/admin/pick'} ? 'active'">
            추천 상품 관리
          </a>
        </div>
      </div>

      <!-- 쿠폰 관리 -->
      <div class="sidebar-section">
        <h3>쿠폰 관리</h3>
        <div class="submenu">
          <a th:href="@{/admin/coupon}"
             th:classappend="${currentUri == '/admin/coupon'} ? 'active'">
            쿠폰 관리
          </a>
        </div>
      </div>

      <!-- 공지사항 관리 -->
      <div class="sidebar-section">
        <h3>공지사항 관리</h3>
        <div class="submenu">
          <a th:href="@{/admin/notice}"
             th:classappend="${currentUri == '/admin/notice'} ? 'active'">
            공지사항 목록
          </a>
          <a th:href="@{/admin/notice/add}"
             th:classappend="${currentUri == '/admin/notice/add'} ? 'active'">
            공지사항 작성
          </a>
        </div>
      </div>

      <!-- 문의 관리 -->
      <div class="sidebar-section">
        <h3>1:1 문의 관리</h3>
        <div class="submenu">
          <a th:href="@{/admin/inquiries}"
             th:classappend="${currentUri == '/admin/inquiries'} ? 'active'">
            1:1 문의 목록
          </a>
        </div>
      </div>

      <!-- 로그 관리 -->
      <div class="sidebar-section">
        <h3>로그 관리</h3>
        <div class="submenu">
          <a th:href="@{/admin/logs/logManagement}"
             th:classappend="${currentUri == '/admin/logs/logManagement'} ? 'active'">
            ERROR / 로그인
          </a>
        </div>
      </div>
    </th:block>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const sidebarSections = document.querySelectorAll('.sidebar-section h3');

    sidebarSections.forEach(section => {
      section.addEventListener('click', (e) => {
        if (e.target.tagName === 'A') return;

        const submenu = section.nextElementSibling;

        if (submenu && submenu.classList.contains('submenu')) {

          // 모든 서브메뉴 닫음
          document.querySelectorAll('.submenu').forEach(sub => {
            if (sub !== submenu) {
              sub.classList.remove('active');
              sub.style.maxHeight = '0px';
            }
          });

          // 현재 클릭된 메뉴 열기 / 닫기
          submenu.classList.toggle('active');

          if (submenu.classList.contains('active')) {
            submenu.style.maxHeight = submenu.scrollHeight + 'px';
          } else {
            submenu.style.maxHeight = '0px';
          }
        }
      });

      // 현재 페이지와 일치하는 메뉴 자동 펼침
      const submenu = section.nextElementSibling;
      if (submenu && submenu.querySelector('a.active')) {
        submenu.classList.add('active');
        submenu.style.maxHeight = submenu.scrollHeight + 'px';
      }
    });
  });
</script>
</body>
</html>